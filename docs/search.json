[
  {
    "objectID": "analysis/index.html",
    "href": "analysis/index.html",
    "title": "Analyses",
    "section": "",
    "text": "This page lists all available analyses for the project.\n\nAnalysis 1\nAnalysis 2"
  },
  {
    "objectID": "analysis/01-explore.html",
    "href": "analysis/01-explore.html",
    "title": "RIVERSEA: Preliminary explorations",
    "section": "",
    "text": "Load dependencies.\n\nlibrary(renv)\nrenv::load()\nrenv::restore() # Install missing librairies.\nrenv::status() # Check the project state.\n\n\nlibrary(zen4R)\nlibrary(here)\n\nDownload data from Zenodo. The data file is relatively heavy (~800Mb), this operation can take a few minutes.\n\ndoi &lt;- \"10.5281/zenodo.17962542\"\ndest_dir &lt;- here(\"data\")\n\n\nif (!dir.exists(dest_dir)) dir.create(dest_dir, recursive = TRUE)\ndownload_zenodo(doi, path = dest_dir)\nunzip(here(dest_dir, \"miste_data.zip\"), exdir = dest_dir)\n\nIf everything went well, the data should have been downloaded in data/zenodo/."
  },
  {
    "objectID": "analysis/01-explore.html#load-data",
    "href": "analysis/01-explore.html#load-data",
    "title": "RIVERSEA: Preliminary explorations",
    "section": "2.1 Load data",
    "text": "2.1 Load data\n\nbase::load(here(dest_dir, \"zenodo\", \"processed_data\", \"poissons_env_temp.RData\"))\n\ncatches\n\n# A tibble: 69,823 × 6\n   sta_id pop_id ope_id annee esp_code_alternatif effectif\n    &lt;int&gt;  &lt;int&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;                  &lt;int&gt;\n 1   8530  31870  19943  2017 TRF                      159\n 2   8530  31870  19943  2017 VAI                       82\n 3   8530  31870  19944  2011 TRF                      217\n 4   8530  31870  19944  2011 VAI                        7\n 5   8530  31870  19945  2009 TRF                      232\n 6   8530  31870  19945  2009 VAI                        9\n 7   8530  31870  19946  2007 TRF                      213\n 8   8530  31870  19946  2007 VAI                       36\n 9   8530  31870  83029  2019 TRF                      126\n10   8530  31870  83029  2019 VAI                      104\n# ℹ 69,813 more rows\n\n\nLet’s rename column for clarity.\n\ncatches &lt;- catches |&gt;\n    rename(\n        species = esp_code_alternatif,\n        year = annee,\n        abundance = effectif\n    )\nspecies_names &lt;- unique(catches$species)\n\nNext, let’s add zeros where species are not found.\n\nlibrary(tidyr)\ncatches &lt;- catches |&gt;\n    pivot_wider(\n        names_from = species,\n        values_from = abundance,\n        values_fill = list(abundance = 0)\n    ) |&gt;\n    pivot_longer(\n        cols = species_names,\n        names_to = \"species\",\n        values_to = \"abundance\"\n    )"
  },
  {
    "objectID": "analysis/01-explore.html#preliminary-plots",
    "href": "analysis/01-explore.html#preliminary-plots",
    "title": "RIVERSEA: Preliminary explorations",
    "section": "2.2. Preliminary plots",
    "text": "2.2. Preliminary plots\nLet’s plot abundance histogram for each species. As most species abundance are dominated by zeros, because of absence data, we plot log(abundance + 1) instead of raw abundances. This also implies that we will need to use zero-inflated distributions in our statistical model to account for this absence data.\n\nlibrary(ggplot2)\ncatches |&gt;\n    ggplot(aes(x = abundance + 1)) + # add 1 to avoid log(0)\n    geom_histogram(binwidth = 0.5) +\n    scale_x_log10() +\n    facet_wrap(~species)\n\n\n\n\n\n\n\n\nLet’s plot abundance time series for the 10 most abundant species.\n\nn_species &lt;- 10\ncommon_species &lt;- catches |&gt;\n    group_by(species) |&gt;\n    summarise(mean_abundance = mean(abundance)) |&gt;\n    arrange(desc(mean_abundance)) |&gt;\n    slice(1:n_species) |&gt;\n    pull(species)\n\ncatches |&gt;\n    filter(species %in% common_species) |&gt;\n    group_by(year, species) |&gt;\n    summarise(mean_abundance = mean(abundance)) |&gt;\n    ggplot(aes(x = year, y = mean_abundance, colour = species)) +\n    geom_line()\n\n\n\n\n\n\n\n\nThere is no clear trend, but we can’t say much at this point because trend may be masked by sampling efforts and environmental covariates."
  },
  {
    "objectID": "analysis/01-explore.html#environmental-data",
    "href": "analysis/01-explore.html#environmental-data",
    "title": "RIVERSEA: Preliminary explorations",
    "section": "2.3. Environmental data",
    "text": "2.3. Environmental data\nNext, let’s focus on environmental variable that is available, so we can build a statistical model relating environment and fish abundances.\n\nenv &lt;- env |&gt; rename(year = annee)\ndata &lt;- left_join(catches, env, by = c(\"sta_id\", \"pop_id\", \"year\", \"ope_id\"))\n\nStation geographical coordinates are stored in points_geo_&lt;river&gt;. We visualize them over the hydrographic network.\n\nplot(net, col = \"black\", cex = 0.5)\nplot(points_geo_vilaine, col = \"red\", add = TRUE, pch = 16, cex = 0.5)"
  },
  {
    "objectID": "analysis/01-explore.html#eel-and-altitude",
    "href": "analysis/01-explore.html#eel-and-altitude",
    "title": "RIVERSEA: Preliminary explorations",
    "section": "2.4. Eel and altitude",
    "text": "2.4. Eel and altitude\nTo begin with, let’s focus on a single species, Eel (ANG), and environmental variable, altitude (in meter).\n\nenv |&gt;\n    group_by(sta_id) |&gt;\n    summarise(alt_avg = mean(altitude)) |&gt;\n    filter(is.na(alt_avg))\n\n# A tibble: 2 × 2\n  sta_id alt_avg\n   &lt;int&gt;   &lt;dbl&gt;\n1   8853      NA\n2  13994      NA\n\n\n\nd &lt;- inner_join(env, points_geo_vilaine) |&gt;\n    select(c(\"pop_id\", \"altitude\", \"geometry\")) |&gt;\n    distinct()\n\nplot(st_as_sf(d)[2])\n\n\n\n\n\n\n\n\n\nlibrary(terra)\nlibrary(tmap)\nstations &lt;- st_as_sf(d)\ngrid &lt;- terra::rast(stations, nrows = 20, ncols = 20)\nxy &lt;- terra::xyFromCell(grid, 1:ncell(grid))\ncoop &lt;- st_as_sf(as.data.frame(xy),\n    coords = c(\"x\", \"y\"),\n    crs = st_crs(stations)\n)\ntm_shape(coop) + tm_dots(fill = \"gray\") +\n    tm_shape(st_as_sf(d)) + tm_dots(\"altitude\", size = 1)\n\n\n\n\n\n\n\n\n\nlibrary(gstat)\nres &lt;- gstat(\n    formula = altitude ~ 1, locations = stations,\n    nmax = nrow(stations), set = list(idp = 1)\n)\nresp &lt;- predict(res, coop)\n\n[inverse distance weighted interpolation]\n\nresp$x &lt;- st_coordinates(resp)[, 1]\nresp$y &lt;- st_coordinates(resp)[, 2]\nresp$pred &lt;- resp$var1.pred\n\npred &lt;- terra::rasterize(resp, grid, field = \"pred\", fun = \"mean\")\ntm_shape(pred) +\n    tm_raster(col.scale = tm_scale_continuous(limits = c(0, 150), values = \"viridis\")) +\n    tm_shape(stations) +\n    tm_dots(\"altitude\", col.scale = \"viridis\")\n\n\n\n\n\n\n\n\nTODO: - Plot stations on top of hydrographic bassin. - Estimate missing values in environmental data. - Model fish abundances depending on environmental variables."
  }
]